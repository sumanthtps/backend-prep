---

title: Decomposing `docker pull`
sidebar_position: 41
---------------------

## Introduction

To understand what happens behind the scenes during a `docker pull`, it helps to enable Docker’s **debug logging**. This section walks through modifying Docker’s configuration, enabling debug mode, and preparing to observe the `pull` workflow in detail.

---

## Enabling Debug Logging in Docker

Docker does not display debug-level logs by default. To see detailed
information, we modify the `daemon.json` file.

### 1. Access the Docker Engine Environment

Depending on your setup:

- **Mac with Lima:**

  ```bash
  limactl shell docker
  ```

- **Windows with WSL:** Open Ubuntu shell in Terminal.

- **Docker Desktop:**

  ```bash
  docker run -it --rm --privileged --pid=host justincormack/nsenter1
  ```

- **Linux with native Docker:** Simply use your terminal.

---

### 2. Create/Modify `/etc/docker/daemon.json`

Check if the file exists:

```bash
stat /etc/docker/daemon.json
```

If it doesn’t exist, create it with debug enabled:

```bash
sudo sh -c 'echo "{\"debug\": true}" > /etc/docker/daemon.json'
```

Verify contents:

```bash
sudo cat /etc/docker/daemon.json
```

You should see:

```json
{
  "debug": true
}
```

---

### 3. Restart Docker Service

Restart based on your OS:

- Ubuntu/Debian:

  ```bash
  sudo service docker restart
  ```

- Systemd-based:

  ```bash
  sudo systemctl restart docker
  ```

- SysVinit:

  ```bash
  sudo /etc/init.d/docker restart
  ```

---

### 4. Confirm Docker Is Running

Run a test container:

```bash
docker run hello-world
```

Seeing the “Hello from Docker!” message confirms Docker restarted correctly.

---

## What This Enables

- With `debug` set to `true`, Docker’s logs now include:

  - HTTP calls to registries
  - Layer download and extraction details
  - Authentication steps
  - Content-addressable storage operations

- Next time you run:

  ```bash
  docker pull nginx
  ```

  You’ll see the entire process in `/var/log/docker.log` or via
  `journalctl -u docker`.

---

## Key Points

- `daemon.json` is the central configuration file for the Docker daemon.
- Debug mode provides low-level visibility into container lifecycle and image
  pulls.
- Always restart the Docker service after editing `daemon.json`.

---

## Questions and Answers

### Q1: What happens if `daemon.json` is malformed?

**A:** Docker will fail to start. Use `journalctl -u docker` to see errors and
fix the JSON syntax.

---

### Q2: Is debug mode recommended in production?

**A:** No. It generates large log files and can impact performance. Use it for
troubleshooting only.

---

### Q3: Can you set debug mode via command-line?

**A:** Yes, by starting the daemon with:

```bash
dockerd --debug
```

But persistent configuration is done via `daemon.json`.

---

### Q4: Does Kubernetes use `daemon.json`?

**A:** Yes. Nodes running Docker as a runtime use the same daemon configuration
file. Containerd/CRI-O have their own configs.

---

### Q5: Where are Docker daemon logs stored?

**A:**

- Systemd: `journalctl -u docker`
- SysVinit: `/var/log/docker.log`
