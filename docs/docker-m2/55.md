---

id: copying-data-from-volumes
title: Copying Data from Volumes
sidebar_label: Copying Data from Volumes
sidebar_position: 79
---------------------

## Summary

While Docker volumes are great for persistent storage, copying data **to and from volumes** can be tricky if you're unfamiliar with the safest and most portable method. This section teaches how to **back up and restore Docker volumes using `tar` inside a container**, rather than relying on host-level paths.

---

## Key Concepts

### ‚úÖ Recommended Backup and Restore Strategy

Use a **containerized `tar`** process with two mounts:

1. **Bind mount** to your host directory (for backup.tar file)
2. **Volume mount** to the container path (for source/target volume)

---

## üîÑ Backing Up a Volume

### Goal:

Backup contents of volume `super-duper-important` to `backup.tar` in current
host directory.

### Command:

```bash
docker run --rm \
  -v "$PWD:/target" \
  -v super-duper-important:/backup \
  alpine \
  tar cvzf /target/backup.tar -C /backup .
```

| Option              | Description                                             |
| ------------------- | ------------------------------------------------------- |
| `-v $PWD:/target`   | Bind mounts current directory to `/target` in container |
| `-v volume:/backup` | Mounts Docker volume inside container                   |
| `tar cvzf`          | Create archive, verbose, gzip compression               |
| `-C /backup .`      | Change to backup dir, compress its contents only        |

---

## üì¶ Confirming Backup Contents

```bash
tar -tf backup.tar
```

You should see your files (e.g., `README`, `config.json`, etc.)

---

## ‚ôªÔ∏è Restoring the Volume

### Step 1: Create a New Volume

```bash
docker volume create super-duper-important-restore
```

### Step 2: Run the Restore Command

```bash
docker run --rm \
  -v "$PWD:/target" \
  -v super-duper-important-restore:/restore \
  alpine \
  tar xvzf /target/backup.tar -C /restore
```

| Flag          | Meaning                          |
| ------------- | -------------------------------- |
| `xvzf`        | Extract archive, verbose, gunzip |
| `-C /restore` | Extract into mounted volume path |

---

## ‚úÖ Verifying the Restore Worked

You can mount the restored volume into a new container and inspect its contents:

```bash
docker run --rm \
  -v super-duper-important-restore:/restore \
  alpine \
  cat /restore/README
```

Output:

```
hello world
```

---

## üß† Why Not Copy from Host Path?

Although `docker volume inspect` reveals the volume's host path (e.g.,
`/var/lib/docker/volumes/...`), you **should not** rely on:

- Hardcoded paths
- OS-specific mount points
- Permissions and limitations of drivers (e.g., NFS, CIFS)

Always prefer volume-level operations **inside containers** for reliability and
portability.

---

## Common Errors on macOS (Lima VM Fix)

If you're on macOS and use Lima VM (e.g., with `colima` or `docker-desktop`),
you might get permission errors when writing `backup.tar`. In that case:

1. Run `limactl edit docker`
2. Add `writable: true` under your home directory mount
3. Restart VM: `limactl stop docker && limactl start docker`

---

## Questions and Answers

### Q1: Why should we use tar inside containers instead of accessing volume paths directly?

**A:** Because volume paths differ by driver and OS. Tar within containers is
**portable, consistent, and safe**.

---

### Q2: What does `-C /backup .` in the tar command do?

**A:** It changes directory into `/backup` and compresses only its contents, not
the full absolute path.

---

### Q3: Can this method work for any volume?

**A:** ‚úÖ Yes ‚Äî works for any driver where container has access to volume.

---

### Q4: How to verify contents of a `.tar` archive?

**A:** Run `tar -tf backup.tar` to list the files inside.

---

## Summary of Backup/Restore Commands

### Backup:

```bash
docker run --rm \
  -v "$PWD:/target" \
  -v my-volume:/backup \
  alpine \
  tar cvzf /target/backup.tar -C /backup .
```

### Restore:

```bash
docker run --rm \
  -v "$PWD:/target" \
  -v new-volume:/restore \
  alpine \
  tar xvzf /target/backup.tar -C /restore
```

---
