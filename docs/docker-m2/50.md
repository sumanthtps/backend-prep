---

id: advanced-network-drivers
title: Advanced Network Drivers and Network Plugins
sidebar_label: Advanced Network Drivers
sidebar_position: 74
---------------------

## Summary

While most Docker containers use the default **bridge**, **host**, or **none** networking modes, Docker also supports **advanced network drivers** such as `macvlan`, `ipvlan`, and `overlay`. These are ideal for complex networking setups, such as:

* Assigning containers real IP addresses on your LAN
* Creating high-performance or isolated container networks
* Building multi-host container networks using overlays
* Adding 3rd-party capabilities via plugins like Weave Net

---

## Key Advanced Drivers

### 1. `macvlan` Driver

- Gives each container a **real IP address** on the physical LAN
- Creates **unique MAC addresses** for each container
- Good for:

  - Home automation
  - Music/media servers
  - Applications that rely on LAN discovery

- Can **overload your router** with too many MACs

```bash
docker network create -d macvlan \
  --subnet=192.168.1.0/24 \
  --gateway=192.168.1.1 \
  -o parent=eth0 \
  my-macvlan
```

---

### 2. `ipvlan` Driver

- Also gives containers real IPs but shares the **same MAC address**
- More scalable than `macvlan`
- Modes:

  - **L2 Mode**: Acts like `macvlan` with a shared MAC
  - **L3 Mode**: Host routes traffic, containers don’t go through bridge

```bash
docker network create -d ipvlan \
  --subnet=192.168.1.0/24 \
  --gateway=192.168.1.1 \
  -o parent=eth0 \
  my-ipvlan
```

📝 In `L2` mode, you must use `--gateway`. In `L3` mode, Docker does the
routing.

---

### 3. Address Management Enhancements

- **Preventing IP Conflicts**:

  - `--aux-address host=192.168.1.2` prevents Docker from assigning that IP

- **Restricting IP Ranges**:

  - `--ip-range=192.168.1.64/26` allows only specific addresses to be used

---

## IP Calculation Example

Given:

- Subnet: `192.168.1.0/24`
- Gateway: `192.168.1.1`
- Reserved IP: `192.168.1.2` (your host)
- IP range: `192.168.1.64/26`

Usable IPs for containers: **192.168.1.64 to 192.168.1.127** (64 addresses)

---

## 4. `overlay` Driver

- Enables networking between containers on **different Docker hosts**
- Used in **Docker Swarm**, **Kubernetes**, and **Nomad**
- Operates by:

  1. **Agents** on each node intercept traffic
  2. **Virtual interfaces** wrap packets
  3. **Tunnels** send encrypted packets over real network

- Tunnel tech: `VXLAN`, `WireGuard`

Overlay goal:

> Make containers on different hosts appear to be on the **same network**.

![Overlay Network Diagram](https://docs.docker.com/network/images/overlay-network-diagram.png)

---

## Network Plugins

Docker supports **pluggable network drivers** via **network plugins**.

### Example: Weave Net (by Weaveworks)

- Multi-host networking (like overlay)
- Service discovery
- Network policies and segmentation

Installable from Docker Hub or GitHub.

---

## Missing Concepts Explained

| Concept                         | Explanation                                                                 |
| ------------------------------- | --------------------------------------------------------------------------- |
| `-o parent=eth0`                | Tells Docker which interface to bind the macvlan/ipvlan to                  |
| `--aux-address` vs `--ip-range` | Exclude specific IPs vs allow only a specific CIDR block                    |
| MAC flooding issue              | Too many unique MACs (from macvlan) may exhaust router tables               |
| L3 ipvlan mode                  | Avoids a gateway, lets Docker handle routing (better for clustered use)     |
| 3rd-party plugin support        | Any CNI-compliant or libnetwork-compliant driver can be plugged into Docker |

---

## Q\&A

### Q1: When should I use macvlan?

**A:** When containers must appear as **real devices** on the LAN (e.g., for
discovery).

---

### Q2: Why might macvlan slow down my home network?

**A:** It gives every container a **unique MAC address**, which can **overload
router tables**.

---

### Q3: How does ipvlan solve the MAC overload problem?

**A:** All containers share the **same MAC address**, so routers don’t get
overwhelmed.

---

### Q4: What is an overlay network used for?

**A:** It connects containers on **multiple hosts** as if they’re on the same
network.

---

### Q5: What is Weave Net?

**A:** A 3rd-party **network plugin** that adds advanced features like:

- Encrypted traffic
- DNS-based service discovery
- Built-in segmentation

---

## References

- [Docker macvlan Docs](https://docs.docker.com/network/network-tutorial-macvlan/)
- [Docker overlay Docs](https://docs.docker.com/network/drivers/overlay/)
- [Weave Net GitHub](https://github.com/weaveworks/weave)
- [CIDR Calculator](https://www.ipaddressguide.com/cidr)

---
