---

title: Adding and Copying Files with COPY and ADD
sidebar_position: 47
---------------------

## Introduction

When building container images, it's often necessary to include files or directories (like config files, scripts, or static assets) in your Docker image. The `Dockerfile` provides two instructions for this:

* `COPY`: Secure and recommended
* `ADD`: Older, feature-rich but discouraged for general use

This section explains how to use these commands, when to choose one over the other, and includes examples with advanced options like wildcards and ownership settings.

---

## COPY vs ADD — What’s the Difference?

| Feature                | `COPY`                        | `ADD`                       |
| ---------------------- | ----------------------------- | --------------------------- |
| Copy local files       | ✅                            | ✅                          |
| Supports wildcards     | ✅                            | ✅                          |
| Auto-decompress `.tar` | ❌                            | ✅                          |
| Download from URL      | ❌                            | ✅ _(e.g., tar files only)_ |
| Docker-recommended     | ✅ (more predictable, secure) | ❌ (legacy, multi-purpose)  |

### Why `COPY` is Preferred

In 2017, Docker maintainers decided that `ADD` was too powerful and tried to
deprecate it. But millions of Dockerfiles were already using `ADD`, so they
introduced `COPY` as a **simpler, safer alternative**.

> ✅ Use `COPY` unless you **need** `ADD`’s extra features.

---

## COPY Syntax

```dockerfile
COPY [OPTIONS] <src>... <dest>
```

- `<src>`: One or more files or directories from the **build context**
- `<dest>`: The destination **inside the image**
- `OPTIONS`: Optional flags like `--chown`

---

## COPY Examples

### 1. Copy file into container

```dockerfile
COPY index.html /usr/share/nginx/html/
```

This copies `index.html` (from the build context) into `/usr/share/nginx/html/`
in the container.

---

### 2. Copy directory into container

```dockerfile
COPY config/ /etc/myapp/
```

Copies the contents of the local `config/` directory into `/etc/myapp/` in the
image.

---

### 3. Wildcard COPY

Let’s say your context has:

```
songs/
├── song-1.mp3
├── song-2.mp3
├── songA.mp3
└── songB.mp3
```

#### a. Using `?` (single character wildcard)

```dockerfile
COPY songs/song-?.mp3 /music/
```

- Copies `song-1.mp3`, `song-2.mp3`
- Does **not** copy `songA.mp3` or `songB.mp3`

#### b. Using `*` (multi-character wildcard)

```dockerfile
COPY songs/song*.mp3 /music/
```

- Copies **all files** starting with `song` regardless of naming pattern

---

## ADD Syntax

```dockerfile
ADD [OPTIONS] <src>... <dest>
```

Same syntax as `COPY`, but with extra functionality.

### Example 1: Auto-extract `.tar.gz`

```dockerfile
ADD app.tar.gz /opt/
```

This will:

- Automatically extract `app.tar.gz` into `/opt/`
- Only works with `.tar`, `.tar.gz`, `.tar.bz2`, `.tar.xz`

> ⚠️ `COPY` would just place the file without extracting it.

### Example 2: Download from URL

```dockerfile
ADD https://example.com/app.tar.gz /opt/
```

- Docker downloads the file and extracts it (if it's a tar archive)

> ⚠️ This only works if the file is a `.tar` format. URLs for `.zip` or `.deb`
> will not be extracted.

---

## Advanced: `--chown` Option

Use `--chown=user:group` to set ownership inside Linux containers:

```dockerfile
COPY --chown=appuser:appgroup app.config /etc/myapp/
```

- Ensures the file is owned by the correct user inside the container
- Useful for containers that don’t run as root

---

## Advanced: `--link` Option

```dockerfile
COPY --link file.txt /data/
```

- Adds file into a **blank layer** to avoid impacting cache of previous layers
- Helps with image size optimization when files change frequently

---

## Summary

| Instruction | Purpose                               | When to Use                            |
| ----------- | ------------------------------------- | -------------------------------------- |
| `COPY`      | Copy files/directories from context   | ✅ Always, unless you need `ADD`       |
| `ADD`       | Copy + auto-extract `.tar`, URL fetch | ⚠️ Only for `.tar` or `http` downloads |

---

## Common Mistakes

| Mistake                                     | Explanation                                                           |
| ------------------------------------------- | --------------------------------------------------------------------- |
| Using `ADD` instead of `COPY`               | Not secure or predictable unless `.tar` or URL download is required   |
| Forgetting trailing slash in destination    | May cause file to be copied _as a file_ instead of _into_ a directory |
| Copying files outside the context directory | Docker only allows copying from inside the **build context**          |

---

## Quiz Practice (Examples)

**Q1: What does this Dockerfile line do?**

```dockerfile
COPY songs/song-?.mp3 /music/
```

✅ Copies `song-1.mp3`, `song-2.mp3` ❌ Skips `songX10.mp3` (because `?` is only
one character)

---

**Q2: Why should you use `COPY` instead of `ADD`?**

- `COPY` is:

  - More secure
  - Easier to predict
  - Less prone to accidental URL downloads or auto-extraction

---

**Q3: What happens if you do this?**

```dockerfile
COPY app.tar.gz /opt/
```

- Using `COPY`: file is copied **as-is**
- Using `ADD`: file is **auto-extracted**

---

You now know how to copy and add files into Docker images safely and correctly.
Up next: running commands inside the container using `RUN`.
