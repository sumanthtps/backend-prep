---
sidebar_position: 5
---
# Advanced Indexing 
Indexes are critical for optimizing database performance. Let‚Äôs dive deeper into **index types, strategies, maintenance, and optimizations**.  

---

## **1Ô∏è‚É£ When Should You Use Indexes?**  
Indexes **speed up queries**, but they **consume disk space** and **slow down writes (`INSERT, UPDATE, DELETE`)**. Use indexes when:  
‚úî Searching large datasets (`SELECT WHERE column = value`).  
‚úî Sorting results (`ORDER BY`).  
‚úî Filtering data (`WHERE`, `HAVING`).  
‚úî Enforcing uniqueness (`UNIQUE INDEX`).  
‚úî Optimizing **JOINs** on foreign keys.  

**‚ö†Ô∏è Avoid excessive indexing!** Too many indexes **slow down inserts and updates**.  

---

## **2Ô∏è‚É£ B-Tree Index (Default & Most Common)**
- Best for **equality (`=`) and range queries (`<, >, BETWEEN`)**.  
- Auto-created for `PRIMARY KEY` and `UNIQUE` constraints.  

‚úÖ **Example:**  
```sql
CREATE INDEX idx_users_email ON users(email);
```
üöÄ **Speeds up:**  
```sql
SELECT * FROM users WHERE email = 'alice@example.com';
```

---

## **3Ô∏è‚É£ Hash Index (Fastest for Equality Checks)**
- **Only works for `=` queries** (not range queries).  
- ‚ö†Ô∏è **Not used by default** unless specified.  

‚úÖ **Example:**  
```sql
CREATE INDEX idx_users_email_hash ON users(email) USING HASH;
```
üöÄ **Speeds up:**  
```sql
SELECT * FROM users WHERE email = 'bob@example.com';
```

---

## **4Ô∏è‚É£ GIN Index (JSONB, Full-Text, Arrays)**
**Best for:**  
‚úî **JSONB** field lookups.  
‚úî **Full-text search** (documents, articles).  
‚úî **Array searches (`@>`, `<@`, `&&`)**.  

‚úÖ **Example (JSONB Search):**  
```sql
CREATE INDEX idx_users_data ON users USING GIN (data);
```
üöÄ **Query JSON field:**  
```sql
SELECT * FROM users WHERE data @> '{"name": "Alice"}';
```

‚úÖ **Example (Full-Text Search):**  
```sql
CREATE INDEX idx_articles_content ON articles USING GIN (to_tsvector('english', content));
```
üöÄ **Query full-text search:**  
```sql
SELECT * FROM articles WHERE to_tsvector('english', content) @@ to_tsquery('PostgreSQL');
```

---

## **5Ô∏è‚É£ BRIN Index (Efficient for Large Sorted Data)**
- Stores **summary metadata** instead of indexing all rows.  
- **Great for large, sorted datasets** (e.g., logs, timestamps).  

‚úÖ **Example:**  
```sql
CREATE INDEX idx_logs_timestamp ON logs USING BRIN (created_at);
```
üöÄ **Efficient query:**  
```sql
SELECT * FROM logs WHERE created_at > '2024-01-01';
```

---

## **6Ô∏è‚É£ Partial Indexes (Indexing Only Some Rows)**
- Saves space and **improves performance by indexing a subset of data**.  
- Useful when queries focus on a **specific condition**.  

‚úÖ **Example:**  
```sql
CREATE INDEX idx_active_users ON users(email) WHERE is_active = true;
```
üöÄ **Speeds up:**  
```sql
SELECT * FROM users WHERE is_active = true AND email = 'alice@example.com';
```

---

## **7Ô∏è‚É£ Covering Indexes (Index + Extra Columns)**
- Stores extra column values **inside the index** to avoid fetching from the table.  
- Improves **query speed by reducing table lookups**.  

‚úÖ **Example:**  
```sql
CREATE INDEX idx_users_email ON users (email) INCLUDE (name);
```
üöÄ **Query without fetching from table:**  
```sql
SELECT email, name FROM users WHERE email = 'alice@example.com';
```

---

## **8Ô∏è‚É£ Expression Indexes (Index on a Function)**
- Creates an index on **computed values** (e.g., lowercase emails).  
- **Best for:** Case-insensitive searches.  

‚úÖ **Example:**  
```sql
CREATE INDEX idx_lower_email ON users (LOWER(email));
```
üöÄ **Query optimized:**  
```sql
SELECT * FROM users WHERE LOWER(email) = 'alice@example.com';
```

---

## **9Ô∏è‚É£ Multi-Column Indexes**
- Index **multiple columns together**.  
- **Query order matters** (left-to-right priority).  

‚úÖ **Example:**  
```sql
CREATE INDEX idx_users_name_email ON users (name, email);
```
üöÄ **Fast for queries using both columns:**  
```sql
SELECT * FROM users WHERE name = 'Alice' AND email = 'alice@example.com';
```

---

## **üîç Understanding Index Usage: EXPLAIN ANALYZE**
To **check if an index is being used**, run:  
```sql
EXPLAIN ANALYZE SELECT * FROM users WHERE email = 'alice@example.com';
```
Look for `Index Scan`, `Bitmap Index Scan`, or `Sequential Scan`:  
- **Index Scan** ‚Üí Index is used! ‚úÖ  
- **Sequential Scan** ‚Üí No index is used. üö®  

---

## **üìù Quiz - Advanced Indexing**
1Ô∏è‚É£ Which index type is best for **full-text search**?  
2Ô∏è‚É£ When should you use a **BRIN index**?  
3Ô∏è‚É£ What is the benefit of a **partial index**?  
4Ô∏è‚É£ How can you index a column **case-insensitively**?  
5Ô∏è‚É£ What SQL command helps check if an index is being used?  

Drop your answers, and we‚Äôll move forward! üöÄ